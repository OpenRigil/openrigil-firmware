#include <stdint.h>
#include "mmio.h"

#define MMM_STATUS  0x2000
#define MMM_CONTROL 0x2004
#define MMM_PPRIME  0x2008
#define MMM_P       0x200C
#define MMM_A       0x2010
#define MMM_B       0x2014
#define MMM_IW      0x2018
#define MMM_IW2     0x201C
#define MMM_OUT     0x2020

#define BLOCK 64
#define Three_TEST

#include<stdio.h>
#include<stdlib.h>

#if (BLOCK == 128)
  uint32_t a[BLOCK] = {0x2ad71b22,0x8f218687,0xa406efa0,0xf8b7f24e,0x18a355d7,0x61d65bbd,0x6c6e248c,0xc207219d,0xd0443f9a,0x28ff0f17,0xa231fba7,0x37fecb24,0x871dd04e,0x24db6025,0x5d8763f1,0xce868962,0x80fcb998,0xab0c965,0x54aceb1a,0x372576a6,0x618f26dc,0x56807f8c,0xea1cee58,0x1b5ee3a8,0x4b834caf,0xbb8267d4,0x74eab906,0x47c9f72a,0xfbf3db45,0xf6c9cc8b,0xf2dcb882,0x971a846e,0x750c0643,0x19d438f6,0x4c420283,0xeed3e1a4,0x56ef5499,0x760e07b3,0xa6aa14f2,0x785ad6ad,0x1676b1da,0xf34b7b71,0xb37a4411,0xab0443bb,0xfb6ca4b9,0x48e5700d,0xfcdce4f2,0xe8d2e16f,0xc66d401,0xe0f04e3b,0x80850345,0x89e2d78d,0xbd8a9600,0xdb264f7f,0x22f20fae,0x97ccfcdc,0x6e68e14b,0x3bf9b7e6,0xfc3e6494,0x8cc2b8d7,0x4f966c4a,0x80c8a95d,0x8b3c13e6,0x18e72890,0x76178ba3,0xcdc526ce,0x782f85a2,0x5bab2ce6,0x8eadd953,0xc475bc20,0x898cce75,0x125df569,0x3a9086fd,0xc5540ff0,0x2f38b79f,0x3e9c9596,0xb45326db,0x9ecb5c4,0x99eebb97,0xe50eba30,0x877d372a,0xf7e4fc00,0x205405f1,0xcaaf664,0x50d75022,0xe46f8f23,0x21e07a8d,0xf54529e9,0x2558d689,0x97466f1e,0x473a1387,0x13319275,0xdc3b0ae1,0xd89b425,0xc194afaf,0x683e7b0a,0x26307113,0xa3c097d4,0x6cfec8e,0x284f85b4,0x598e99a5,0x23e1211c,0x2b68e147,0xff06ed27,0x7a4eb6f1,0x880b9c3a,0x58929dca,0xbfa63899,0xc5101631,0xf039229c,0xf45defad,0xa70ce5c2,0xc533a905,0x99d9cf7e,0xd39919d8,0x8213c53b,0x5d45343a,0xa62a438b,0xf298ba0f,0x34537c48,0xd9df8d2f,0x381fd9a4,0x460b5bde,0x20a636b5,0x9fa6de37,0x781b8e1f,0x2d2578af,0x309c1222,};
  uint32_t b[BLOCK] = {0xc44d7360,0x8054edef,0x9c7f1ebd,0x4ee5be2b,0x42aaa6b0,0xf3f6a6d0,0xb062dc92,0xbb6d3d08,0x9083b337,0x7b76be7c,0x80ec5697,0xe78a4ef5,0x4231b21e,0xf111d975,0x2e05d978,0x9c631f96,0x402f3142,0x715c268d,0x79a772cf,0x17a4cdca,0xe0f491a8,0x827a0f5e,0xfb6e146a,0x7f17d9cf,0x63752ba5,0xf0d75c2b,0x9cd6e71a,0xf46eedc6,0x43e525fe,0x267ed7e1,0x9b131315,0xd741f25e,0x6dfc0984,0xca0cbd27,0x4b6d4726,0xbfa50db3,0x7b61cfb2,0xc2e80fb2,0x616eef5f,0xe563ec5c,0xac2f8a8e,0x5301b867,0xfdc53e25,0x50b2dbd7,0xceb7f9e4,0xa247add5,0x70bc7e79,0xd014c350,0x6664a0b2,0x41dadf90,0xc2d0334d,0xdc11507e,0x8c20bdcf,0xa6bc03e9,0xc283d3ca,0xca3daf59,0xdf174df6,0xccda912e,0xa18335a0,0x6e82bb76,0xc7f6e6a4,0xb38c5979,0x1e6ce2cf,0x4945b192,0x7baf856f,0x659f1bbc,0x99ef21ff,0xd19c2392,0x208a4560,0xf0efef03,0xc9197b25,0x3a43672b,0xf04cb000,0xa1aedb29,0xddbefe3c,0xad8251b9,0x21d8293,0x39a53a3e,0x92ab4440,0x5b6b5d01,0xe03b321d,0x974f851f,0x8f0ce8ac,0x347bc66d,0x7e4db7d4,0x796eebb8,0x96190420,0xcd7000cb,0xf95ec532,0x4cfb5d8,0x1d20b2bd,0x8c8d179c,0x8999a46b,0x3efb3f99,0x818d81a3,0x8004bae3,0xe5d5d326,0x6b16ee2a,0x28321f7,0xdcaefff3,0x1723116b,0xed732167,0xc5ed778d,0xa278d356,0xd735a936,0x4046b837,0x1392ca,0x6c967393,0xbd229bd6,0x2a462aeb,0x32c42a19,0x9696a42a,0x6318daea,0xc8ed574,0xd55bae26,0x7ebf0d50,0x4fbd72db,0x2dfe481f,0x905d9bd4,0xb48527e7,0x69c4e42a,0x657d7dc8,0x81121198,0xfc2efaa1,0x6bdacbc5,0x6dd67094,0xcc76d3aa,0xa7611d15,};
  uint32_t p[BLOCK] = {0xfbcba285,0xc04c2b62,0x5b0b08e6,0x740344c7,0x1a5f1291,0x34d43100,0xa5897006,0xa8415ee5,0x5c18c2ef,0x3b5470c9,0xb89c2d96,0x466aaff1,0xb6dd9efa,0x4bbc7749,0x93fc38b3,0x3f00a629,0xcbb288b9,0x1a52a694,0xbe5dc96b,0xadfd2fe8,0x57eda394,0x9b5f4b79,0xa94fd37e,0xea7d5559,0x753bd1a9,0x81dee079,0x738afe08,0x845c9438,0x7ab43358,0xfe88d10c,0x81cbfc76,0xeb3fd86,0x64e17887,0x5dd87a8f,0x97cdb6df,0xb7701af,0xb900b51b,0xd89bd6ba,0x8ebae71c,0x91b1c1e7,0xc73b0db,0x1df4e5e2,0xd94a87c7,0xcb1f57bb,0xbd7e85ae,0x753cb359,0xb51541e3,0xdddd9896,0x90b18ee9,0xd41dd10,0x7aef5496,0x5ff1faf3,0x9549249c,0xab30d7cf,0x65325a92,0x471d9f61,0x7ad1212f,0x4fe87034,0x793d7a6b,0x1dcd09d8,0xe2feb60b,0xd2db01e0,0xf5d0ea7f,0x22427759,0x1a09e701,0x710ff53a,0x56f45224,0xb1e3f439,0xac3bffdd,0x4ade78ee,0x962d20a5,0x1f4c6fa4,0x447613e6,0x2ea29d8f,0xd6d62769,0xf82d88a1,0xb3402540,0x756503de,0xd2077418,0xc8d55e1,0xf16b3547,0xc77f073,0xc58be3db,0xb4157073,0xa2947f44,0x69e4dae5,0x169e76cf,0x9412a3fc,0x80b30795,0xede43b23,0x7a61a2e5,0xb36be6f,0x1a06033a,0x32324b08,0xb7221a5b,0x12ab4ee3,0xe94ce4d9,0xcf079e3c,0x3dee16c0,0x67cb38c,0x78680c58,0x915b3705,0x6db65084,0x3c3a0a94,0x123c0f02,0xa81ffcc9,0xa3e59a09,0x324bbd77,0x501f4b30,0xd3f8f4c3,0x3cc0659c,0x2fc2f7d4,0x276de326,0xbb0dca2f,0x814f04a4,0xf4e78db7,0x686467f,0xb31942ff,0xf027af84,0x55580ff5,0xe9fd5565,0x873d4573,0xa8003491,0x484fbc9d,0x34bf34bd,0xb44e6d55,0xc68c5eb5,0xc99650a7,};
  uint32_t ref[BLOCK] = {0xe1fac06,0x719092b6,0x3dfcd855,0x75beebb9,0x47703ae5,0xbc606500,0xfa966fce,0x6317255a,0xd5792cb6,0x1c6556bb,0x32ed4143,0xb9164047,0x527be45a,0xb7e17cc,0xb5dc562d,0x988070bb,0x89e28eab,0x5bb5c15c,0xb85cd46c,0x95063afa,0xc31659a7,0x4c02c7f8,0xa054c213,0x745b498a,0x58637fcd,0xf7cadbd5,0x8e1ca0cc,0x670078f0,0x3cebfb97,0x229860af,0xfc2dd2f6,0x6d0ce21c,0xf6813a61,0x52dd67e5,0x9437acf6,0xe48bbbe5,0xe5a51697,0x55f9ddb5,0xf1e4459f,0x3d4e3edb,0x784c18fe,0xa7ed8877,0x9aaf2609,0x3d0fec9b,0x260c1d01,0xe2cef082,0x87a2d9b3,0xf76c16f2,0x7880dd23,0x749d2a07,0x22ced995,0x89acf5c7,0x12d84140,0xbe16234,0x9fbcd156,0x6439d430,0xdf85712c,0xec3ed392,0x71b8d500,0x11837e8e,0x6bd9945f,0x6f72ec74,0x58f27894,0xfef26d15,0xe530a38d,0x3e05c49d,0x18a86b5a,0x96d6135,0xd8dba3b0,0x9164da1a,0x35ab0016,0xcc2974d2,0x8c4425d0,0xa1f5e202,0xfbf1ebe6,0x214df6ad,0x987b4449,0x43b4f,0xb8fc9844,0x7966219c,0x3fe1118,0xc3e7761d,0xe196c45b,0x132eaea5,0x5dcb79d8,0x86a08abe,0x6364722a,0x72f44db7,0x70e0d77e,0xa4561782,0x17b56c4,0x6fb73ea6,0x3517942f,0xeecc87e8,0x5cc51e2e,0x565c5fc0,0x191d4278,0x7f5d25c2,0x6536e32c,0x5d637b7,0x6d7a8210,0xd40b62c2,0x6fd3401,0x84753e65,0xe0f5b18,0xe36eb70f,0x6489c127,0x3350c459,0x2e1006c4,0x540f3b05,0x58db8d25,0x4a2da55f,0xd5fffd2c,0xc6dee8c4,0x4db41a9c,0x28a7bc22,0xa9dfe4bc,0x9287aad2,0x12618dc8,0xfaab5ea3,0xf82fb7d7,0xc4d37307,0x2db19cfb,0x20034a1a,0xa5c99ed9,0xcee7796b,0xfa2167f9,0xa9ee3b0,};
  uint32_t a1[BLOCK] = {0xf324ca55,0x737837a1,0x5a176495,0x59eb2bc1,0xe1996108,0xe6abbd4,0x161574ff,0xdd9fd60,0xb45abb4f,0xe7565a91,0x5583aa9c,0xfbb545bb,0x2cf9dec3,0x88d6d9b5,0xee5a64ca,0xb044b5f5,0x36b572c8,0x1c8bedcb,0xdc394665,0x295c9c79,0x8097123a,0xeca8eac3,0x9bbcd3fe,0x21b1e6c8,0xa1d91c99,0x280846f7,0x50553b7a,0xe9695b8,0x72a554fd,0x7053f4a,0x2dff9809,0x97469d00,0x33fb1b65,0x6db9b324,0x41272af8,0x431b1c99,0x4e073108,0xab95921e,0xab7df7fd,0x23006c6a,0x3572ce15,0xf99e3407,0x6cc87d3f,0xedca3611,0xdb5e2674,0x28afd41e,0xf105d158,0x4d4476c3,0x9fb0a617,0x6982a7e9,0x6cdb4e2c,0x73b52959,0xacf98a60,0xfc6e744f,0xba834c71,0x5c8a1b27,0xbf3c8d10,0xc1c39a17,0xcc30395d,0x472db0c4,0x6f85cbd6,0x3d4aa417,0x11f02e1,0x8976d59e,0xd4156a6f,0xc9d2b421,0x8aa7fa1,0x1e47d614,0x28e45619,0x87b7f8cb,0x74655b26,0x4e84d173,0x2c86e38c,0xccd1ed9c,0xb3e16a41,0x4ccea73f,0xb0b8c88e,0x6506cc43,0x690459ec,0xa90e6959,0xe85d1ad4,0x3dc72406,0x757fe657,0xa01a3c36,0xc215722f,0x2ad27b53,0x5305843b,0x2f399bda,0x1ec37b2b,0x849ce807,0x521cba8,0xd0b8a2f0,0xbf677d2c,0x5c19148a,0x4423f8e2,0x1f75d4e3,0xce2151f3,0xdee28e14,0x21ff4765,0x400ffcc1,0xf44157c5,0x6d170301,0xe9f45968,0x79feb8e1,0xc4a0cf63,0x9f381387,0xfb17ffc2,0xdb0b0c5e,0x9b67c1e5,0xaf115b77,0x71634e7,0xf7eef1f8,0x3a449fd7,0xef43ada2,0xc951fc23,0xaab04a84,0x65c23a65,0x87afaa7f,0xd731b2da,0xee55fa30,0x665d2c2c,0x9bf92680,0x80406f0f,0xe7ff6d3e,0x2ca9ac3,0x45619d47,0x2f25275c,0x786b93e2,};
  uint32_t b1[BLOCK] = {0x8eb02bc5,0x9aeac20,0xb3bfc0cc,0x2f09a42c,0xac93648c,0xe12a773,0xff8681c4,0x367c768,0x1f704086,0xc212d4e7,0xbb653af2,0x642716a5,0xcdd083d0,0xf677b74c,0x518d919e,0xe9a5d617,0x555eeff9,0x617cc1e6,0x7e5f58a,0x3f2002cf,0xadce9acf,0x1b42a1bd,0x2c72181f,0x7a6bc0a3,0x5f6147c2,0x4ee716bf,0x14bf1f3e,0x1973858a,0xc566d39f,0x1bb000ed,0xb3e1623,0xa1c4bdd,0xe9d26954,0x7ebae563,0x3b05f1a9,0xe5a3f11,0x5cad6f18,0x7c549f72,0xcf2126e5,0xf684fae4,0x57e0583c,0xfdb39f97,0x65edb679,0xde17cd71,0x9891e3ae,0x89988f70,0x1f92f3ea,0x315df1aa,0xc6b6876f,0xd6cbaeac,0x3770eb91,0x3028b126,0x547a6f8c,0xe04d65a9,0x8922e411,0x48d438c8,0x5875e960,0x8476c23a,0x4b3d4b3c,0x8c529ec4,0xd756c71,0xab511c84,0x6e432274,0x545460a,0xa8b0a316,0xacbb2116,0xf8b31c0e,0x16a78b78,0xf654515a,0x24e39f02,0x8a405285,0xfc70ddb0,0x623e60c0,0x30121a0c,0x43195d30,0x9040972a,0x7c925016,0x97fbf889,0xf4805738,0xbce9ea8d,0x8299a342,0xb2d01100,0x753fd31e,0x8c2e6f76,0x2e6e326c,0x1718898a,0x3b11f816,0x2fc1f179,0xbe8f3f82,0x3c9f87c6,0x39c80202,0xc64dd7a7,0x3c741770,0xad297c78,0x842e328,0x5ec63509,0x5cdf3876,0xcac9f7d1,0x12b2eb17,0x68d92d3b,0xee91ced,0x9229bcb4,0x1caf5bc8,0x6ec38513,0x356a10b9,0x589945b2,0x5b8d794e,0xb3bed95f,0x981c1c03,0x104c2239,0xec72783f,0x85b19cb5,0xc09fddb6,0xbfe2efa5,0x692658b5,0x31be72e1,0xa5568673,0x65dd7b0e,0xf1234527,0x2136389f,0x81653536,0xd9a891e6,0xc43ed69f,0xe0755deb,0xb182af8b,0xbc633411,0x94419c6a,0x2774fbe6,};
  uint32_t p1[BLOCK] = {0xfbcba285,0xc04c2b62,0x5b0b08e6,0x740344c7,0x1a5f1291,0x34d43100,0xa5897006,0xa8415ee5,0x5c18c2ef,0x3b5470c9,0xb89c2d96,0x466aaff1,0xb6dd9efa,0x4bbc7749,0x93fc38b3,0x3f00a629,0xcbb288b9,0x1a52a694,0xbe5dc96b,0xadfd2fe8,0x57eda394,0x9b5f4b79,0xa94fd37e,0xea7d5559,0x753bd1a9,0x81dee079,0x738afe08,0x845c9438,0x7ab43358,0xfe88d10c,0x81cbfc76,0xeb3fd86,0x64e17887,0x5dd87a8f,0x97cdb6df,0xb7701af,0xb900b51b,0xd89bd6ba,0x8ebae71c,0x91b1c1e7,0xc73b0db,0x1df4e5e2,0xd94a87c7,0xcb1f57bb,0xbd7e85ae,0x753cb359,0xb51541e3,0xdddd9896,0x90b18ee9,0xd41dd10,0x7aef5496,0x5ff1faf3,0x9549249c,0xab30d7cf,0x65325a92,0x471d9f61,0x7ad1212f,0x4fe87034,0x793d7a6b,0x1dcd09d8,0xe2feb60b,0xd2db01e0,0xf5d0ea7f,0x22427759,0x1a09e701,0x710ff53a,0x56f45224,0xb1e3f439,0xac3bffdd,0x4ade78ee,0x962d20a5,0x1f4c6fa4,0x447613e6,0x2ea29d8f,0xd6d62769,0xf82d88a1,0xb3402540,0x756503de,0xd2077418,0xc8d55e1,0xf16b3547,0xc77f073,0xc58be3db,0xb4157073,0xa2947f44,0x69e4dae5,0x169e76cf,0x9412a3fc,0x80b30795,0xede43b23,0x7a61a2e5,0xb36be6f,0x1a06033a,0x32324b08,0xb7221a5b,0x12ab4ee3,0xe94ce4d9,0xcf079e3c,0x3dee16c0,0x67cb38c,0x78680c58,0x915b3705,0x6db65084,0x3c3a0a94,0x123c0f02,0xa81ffcc9,0xa3e59a09,0x324bbd77,0x501f4b30,0xd3f8f4c3,0x3cc0659c,0x2fc2f7d4,0x276de326,0xbb0dca2f,0x814f04a4,0xf4e78db7,0x686467f,0xb31942ff,0xf027af84,0x55580ff5,0xe9fd5565,0x873d4573,0xa8003491,0x484fbc9d,0x34bf34bd,0xb44e6d55,0xc68c5eb5,0xc99650a7,};
  uint32_t ref1[BLOCK] = {0xabb50526,0xa2e5558c,0x237e10ea,0x12255027,0x983e26e0,0x7e8c8b52,0x927baf8a,0x74bb3a94,0x70c08677,0x15d9f5fb,0xe939806d,0x62ab7d47,0xb3e2f6ed,0x4d677f25,0x148406ee,0x17113222,0xf4d48165,0xb3ce9a42,0xac57fcdf,0xd2c4c618,0xb9957b2e,0xd4ef65b4,0xdad88aa6,0xf7a80158,0x6cea5a8e,0xd2093e70,0xc96a7447,0x546320ac,0xde291074,0x311e67bc,0xc4c681a,0xb6c9e6e6,0xdfeec843,0xe675f275,0xc7700842,0xdfa9d0f6,0x10f8eb7a,0xa167819e,0x2d9651c4,0xb20983a,0xfe47110b,0x8f4bc533,0x918dc9de,0x3dbb04fa,0x9ddd05d8,0x9877fa08,0x328af79d,0x6b7c45e,0x266e6aaf,0x589521e2,0x5c4dcbab,0x8e8c78ca,0xe06c999c,0x59e2ee9f,0x5b8c3c56,0x75a74cc6,0x562d8acb,0xd625d547,0xb3bf3175,0xe586ef50,0x5d097546,0x1151f349,0x806d8f75,0xb6aab44a,0xdc79ab3c,0xa69c0e4,0x58f839af,0x4b25973a,0xc00df954,0x2fe3fb2f,0x65caad51,0x88604d10,0x84ea067c,0x9f270e8d,0xb18ee864,0xd19a08eb,0xa36c9f7,0x3242c894,0x800c0366,0x45676879,0x3d376afc,0xf63b361f,0x81b64bc6,0x38ebdfdb,0x476dde52,0x5b8dd7f5,0x9b2fe378,0xa62b21c8,0x28dbc36,0xca892b60,0xfad0daa5,0xa452ec59,0xd76ec068,0xd8b3c26c,0x9cf3d9a0,0x23d94daf,0xfe4c31a6,0xd42cb2fd,0x72275565,0xe4a072aa,0xc2c2d2df,0xffee8270,0x80173f52,0xdf2d1848,0x108e67b6,0x552f9fa1,0x93a60754,0xb53ae881,0xc7cb6869,0x7ff71145,0x90515b66,0xa0f7cd60,0xf0604c82,0x9a2dda29,0xc9983e6e,0xa1c826e1,0x2e0f061,0x5afcc648,0x257dd7f7,0xb9f59e4d,0xb003c49d,0xbb92d12d,0xc72692a2,0x2b582506,0x55ec231e,0x7814aaf9,0x9ecd8053,0x48f390db,};
#elif (BLOCK == 64)
  uint32_t a[BLOCK] = {0x528524a4,0xd1434dad,0x86b329bf,0xfea67fa1,0xbe73cbe4,0xe2483838,0xec84e7b9,0x6a6e7729,0x18e5f018,0x692ad1ff,0xe0831ecf,0xb0fe1763,0x41de67e0,0xfe4141b,0x97bb2725,0x16112b74,0x725c137,0xe2f18907,0xad8fde05,0x521c3cbc,0x1a18cef3,0xe8ab42f0,0xc7edb288,0x3b5bdab6,0xaeeebd42,0xeb481b5f,0x99ba59c5,0xad44882a,0x24418e29,0xa3342972,0xce8e72f8,0xe4be89e1,0xe2cbbbcd,0xebf150b1,0x501afe3e,0x7ea6437a,0x963f5597,0x5c4199c5,0xc5684307,0xb72a0414,0xad846324,0x8c0d6621,0xef7d62cf,0xd9c4b58d,0x18bbd5d,0x4cce1d27,0xba846605,0x740948d6,0xa524674,0xcac09816,0xfe3adc66,0x4f3ff87e,0xd1671f5,0x831a2687,0x444954a4,0x4f18d154,0x7f13985d,0xe1cb0238,0xbb2d020,0x1ef226d3,0x32ce65e4,0xe58410ae,0xb2ae5bca,0x4bd1a139,};
  uint32_t b[BLOCK] = {0xb49849ae,0x47ec51e5,0x91625727,0x28bb4925,0x9c3ba312,0x84a7198b,0x7df68929,0xbe524f07,0x3eaf3c64,0xd1c17a20,0xdb44a626,0x7838e8cd,0x55eda90b,0x157ab9a3,0x3888ac15,0xee415aa7,0x10b139a5,0xf78c09aa,0x6bace026,0x788ea21,0x8bc8303c,0xb0b438aa,0x1fd28b60,0x848116fc,0x14dee86c,0xbc295542,0x21c7c2f3,0x424944ec,0x3060b388,0xd2bfa406,0x43b32237,0xd6edaa79,0x7964206b,0x270a41e1,0xe90cae46,0xcb49a4ab,0xe503f930,0x6e7752e7,0x5c564127,0x957e790,0xf3bdaa22,0xc44f06e,0x23d97506,0xf45eb963,0xcd7f9600,0x985176c2,0x1ed1d191,0xf700532e,0x46926b3,0xe0a4e76b,0xcbc49179,0x9a988bb5,0xf7af4caa,0xa614058d,0x85890ed3,0x433827b0,0xa4006df4,0x69201212,0x503bc453,0x4746f2aa,0x36ce9560,0x71cd7f6d,0x5f5ea343,0x10e2f70a,};
  uint32_t p[BLOCK] = {0xabe62b95,0x49891d43,0x71b80c41,0xf83b0299,0xa5f75b99,0x267fc598,0x4665eaf5,0x94945d47,0xbe64b5e5,0x13140dd5,0x5b9230d2,0xbbaa9a43,0x6d4984cf,0xb1ddbb15,0xaafbd048,0xf2d0d807,0x90e90bb1,0x707cb9cd,0x359cb0a2,0x35738d66,0x1f4fef52,0x802807de,0x910e700d,0x30467d86,0x2ac839db,0xc8476544,0x4b65226e,0x1a1eaef5,0xa2580479,0x77872259,0x2c4258aa,0xe29c4ab1,0x6e7fcd9c,0x27525f38,0x8e7fcb4d,0xa697d010,0x23d8b6da,0x3dab44d7,0x10498f2c,0x631673a5,0x1dcb8bd,0x118d6146,0x97b65c38,0x25525fb9,0x53375012,0xaf3b5631,0xb594ee61,0x4b3e4990,0x3d3e7a0b,0xc8a960ab,0x6633d12c,0x7acfd95f,0xe8bd3652,0x9474116b,0x8bfe931c,0x8769f6c9,0xecbdc74b,0x1117b4f8,0x7ec4f188,0xa0594d9a,0x66987e8c,0x63a8d619,0x450214ef,0xbc07d529,};
  uint32_t ref[BLOCK] = {0x6fa7f281,0x35fd37d2,0xdc9e20cc,0x220906f2,0x1556376b,0x392324d,0x13e7a364,0x9e2d1d1f,0x43bf4d19,0x2afe8dbd,0x726ce1a0,0x346c5cf5,0x28bd706f,0xb8c2f287,0x96920e96,0x33edbf1a,0xfb36c06,0xdf874e88,0xe140340,0x2b2bf2a5,0xd6b7534e,0x7ed2cc6f,0xdabaca18,0xe758c64d,0x6a0f2a29,0xa0ef1af5,0xe93f86f5,0xabff6c46,0xa7be9bd4,0xcb324f5f,0xc26498c7,0xfe369a8c,0xaa8218e0,0xe3b5d5fc,0x56e17e1d,0x4bcf2543,0xa09f1c49,0x323bd9e4,0x39e6c6f0,0x69ab9337,0x3af34e4,0x39227eae,0xefc82de9,0x6a06fa24,0xccc25ade,0x497503aa,0xfd036312,0xcc811e6,0x5ab047df,0x887c6e38,0xe72a8da0,0x613b0ebe,0xbfe8d544,0x5e8ed6f,0x60fe3fa5,0x5491a89d,0x978d177a,0xc4027941,0x1afc425d,0x2ec634ee,0xd9391fec,0xfb0af066,0x623ad474,0xa506cc93,};
  uint32_t a1[BLOCK] = {0x279c7168,0xa0fe5d93,0x9c9ae17e,0x9e9e760b,0xef03b7a4,0x52035c32,0xf4d85e34,0xd39c5dd7,0xa3529c6c,0x3f1826d6,0xf69e94b6,0x2931e853,0xcd83308d,0x443e37e2,0x760d5f22,0x4a3aa5e7,0x341f9060,0x6323c920,0x20b9a84b,0xf1ea5d96,0x295a2df0,0x44cb980a,0x2b365c81,0xbf645d0c,0xc45bb7a5,0x27f8119a,0x96018bbb,0x6312a1e9,0xdf9fd8f7,0x9cd63267,0x52a71244,0xe3dc48ea,0x56d7bd8,0x792b9318,0xfff9fc8d,0x4951dda9,0x3b2f4e97,0x7958afdf,0x8efc3811,0x772e67ab,0xd236e144,0xdcc0e91,0x51158810,0x3a9a8d39,0xf7c803fa,0x34a1d657,0xf73dda04,0x2ab4ff75,0xbd96abfa,0x1e179074,0x612d685f,0x886fbfc6,0x9cdafd38,0xa941ec19,0x267d5481,0x3a06a571,0xa2064ea6,0xa74af034,0x5e84c214,0xeb678e73,0xdc94af90,0x9b388cc1,0xa77d412e,0x2b7f6be3,};
  uint32_t b1[BLOCK] = {0xcebecc8,0x5d9a4971,0x6652f998,0x7c2f37e,0x81d33fcf,0x63734be2,0xb40103fb,0x833dbe41,0xfc54dda,0xd864fe28,0xf97a10e0,0xb3d5c345,0x4d717249,0x6c59cc4a,0x7aae2252,0x2e68daca,0x9e3a7082,0x229aac43,0x91b0ed52,0x484fd6a4,0x5406c81b,0xbd7476dc,0x98ae6889,0x5507f949,0xe82b6684,0x4daefe1b,0x98b683f7,0x21d02561,0xcef6128c,0x3c817cc7,0xeaee0494,0x1039ef5b,0xe2d3ef46,0x1fbdcc0a,0xb878b46a,0xfcd883b5,0x3643306,0x5bf8b250,0x7f460816,0x32bc11d8,0x131c28d9,0x4fc2cf0c,0x285b29eb,0xac996166,0x2b31dc6b,0x4ceb557c,0xb9309fed,0x8578b32d,0x39f86ea9,0x5448395b,0x1a66b8a3,0x89f588bf,0x32ed4b08,0x9d3b2001,0x4b6c26c5,0xe3a0e7d0,0xacfced01,0x3c7dd52,0x89e26723,0x90e83aa1,0x20f6ad47,0x24406d9d,0xfd242580,0x4cbc7116,};
  uint32_t p1[BLOCK] = {0xabe62b95,0x49891d43,0x71b80c41,0xf83b0299,0xa5f75b99,0x267fc598,0x4665eaf5,0x94945d47,0xbe64b5e5,0x13140dd5,0x5b9230d2,0xbbaa9a43,0x6d4984cf,0xb1ddbb15,0xaafbd048,0xf2d0d807,0x90e90bb1,0x707cb9cd,0x359cb0a2,0x35738d66,0x1f4fef52,0x802807de,0x910e700d,0x30467d86,0x2ac839db,0xc8476544,0x4b65226e,0x1a1eaef5,0xa2580479,0x77872259,0x2c4258aa,0xe29c4ab1,0x6e7fcd9c,0x27525f38,0x8e7fcb4d,0xa697d010,0x23d8b6da,0x3dab44d7,0x10498f2c,0x631673a5,0x1dcb8bd,0x118d6146,0x97b65c38,0x25525fb9,0x53375012,0xaf3b5631,0xb594ee61,0x4b3e4990,0x3d3e7a0b,0xc8a960ab,0x6633d12c,0x7acfd95f,0xe8bd3652,0x9474116b,0x8bfe931c,0x8769f6c9,0xecbdc74b,0x1117b4f8,0x7ec4f188,0xa0594d9a,0x66987e8c,0x63a8d619,0x450214ef,0xbc07d529,};
  uint32_t ref1[BLOCK] = {0x4dfea821,0xd3008c93,0xb410c072,0x858d6692,0xf11d443a,0x408cafe5,0xbb170923,0xc0f8a632,0xa82af862,0x1cc3ca69,0x2124f891,0x3c3d296,0x9b1766ca,0x2ee32120,0x2892edb6,0xa76d0dfd,0x55fa65e,0x4eaf0fb,0xb0acf74d,0x703f89f0,0x98c89224,0x99d44c6,0x26a13302,0xa2d28698,0xa96a8719,0xa341b69f,0x95fabdde,0x7c78b5d1,0xa8de5c35,0x34c25ef9,0x6b53da45,0x62173ae7,0xf359f9c6,0xad931bb0,0x80bae5fe,0x3264ff1,0xa0a6be8,0x68b3cb85,0x1b8038e,0x32a54de6,0x7887ace3,0x12f2180d,0x9fb16d94,0x1242fb2b,0x8c75c3e1,0xa9c30e13,0xae29e5e6,0xe1e799ca,0x8fe176da,0xb1f6bef3,0xddfb11d6,0xc7f7fc69,0x307ece7e,0x4cd5acc0,0xe933632c,0xeee7d8fa,0x93e7758c,0x97c1d7b8,0xff3d3314,0x5dc126cb,0xb092c05,0x50105a32,0x170397ac,0x4c964ff9,};
#elif (BLOCK == 8)
  uint32_t a[BLOCK] = {0x78b86718,0x6821603,0x7e83c347,0x9b8718bc,0x5833e845,0x60b9435a,0xa787ca1e,0x23830428,};
  uint32_t b[BLOCK] = {0x35144d4b,0xc3cf9739,0x4bf78431,0x1bde0e39,0x25b9dd3a,0xab8db8ca,0x405a44dc,0xc17b4a16,};
  uint32_t p[BLOCK] = {0x51fd36b,0x307f3439,0x38ab3751,0xf880790e,0x1c8aa893,0x2e3f83d0,0xba6dc608,0xe83ae9a9,};
  uint32_t ref[BLOCK] = {0xdcda0671,0x30454c3e,0x52d5a4a1,0xb68dd27c,0xa0eecef9,0xc1db743d,0xe0fff38e,0x80c1751b,};

  uint32_t a1[BLOCK] = {0xd59973d3,0x9705dc51,0x6a2e254a,0x8087e520,0xc57f7849,0xebf90cdf,0x6a63525e,0xb25fa7ba,};
  uint32_t b1[BLOCK] = {0xc7d9c58c,0x6093bed9,0x86489dd2,0x999a8ecc,0xd6e41754,0xb66aaf22,0x9cd225fc,0xd63eb7bb,};
  uint32_t p1[BLOCK] = {0x51fd36b,0x307f3439,0x38ab3751,0xf880790e,0x1c8aa893,0x2e3f83d0,0xba6dc608,0xe83ae9a9,};
  uint32_t ref1[BLOCK] = {0x3880768e,0x3ab570e9,0x14f5546e,0x821fb76c,0x47e70db2,0x1d3e5044,0x1faf5c7c,0x981cbd5d,};
#elif (BLOCK == 4)
  uint32_t a[BLOCK] = {0x8dba0838,0xa56e0f8e,0x40016a5a,0x2c0e10f,};
  uint32_t b[BLOCK] = {0xe693a2f7,0x21ad1b4c,0x8a96a48d,0x1f526ea,};
  uint32_t p[BLOCK] = {0x51b9fe33,0x21f0d7b3,0x194fdac3,0x33eec49,};
  uint32_t ref[BLOCK] = {0x14d194a,0x5c266d48,0x36614e98,0x274f88f,};
  uint32_t a1[BLOCK] = {0xd6ca1d13,0xa32942c4,0x4b40b2,0x0,};
  uint32_t b1[BLOCK] = {0x66a9397d,0xf4f2ab1,0x9cc431,0x0,};
  uint32_t p1[BLOCK] = {0x11a05561,0x8e02b29,0x1b0e72c,0x0,};
  uint32_t ref1[BLOCK] = {0x30c9bef,0xa144d925,0x725129,0x0,};
#elif (BLOCK == 2)
  uint32_t a[BLOCK] = {0xa8f,0};
  uint32_t b[BLOCK] = {0x57a,0};
  uint32_t p[BLOCK] = {0xd01,0};
  uint32_t ref[BLOCK] = {0x6f7,0};
  uint32_t a1[BLOCK] = {0x283,0};
  uint32_t b1[BLOCK] = {0xcb1,0};
  uint32_t p1[BLOCK] = {0xcfb,0};
  uint32_t ref1[BLOCK] = {0x489,0};
#endif

void mmm_test(void)
{
  uint32_t result;
  uint32_t input_width1;
  uint32_t input_width2;

#if (BLOCK == 128)
  input_width1 = 255, input_width2 = 15;
#elif (BLOCK == 64)
  input_width1 = 127, input_width2 = 15;
#elif (BLOCK == 2)
  input_width1 = 3, input_width2 = 15;
#elif (BLOCK == 4)
  input_width1 = 7, input_width2 = 15;
#elif (BLOCK == 8)
  input_width1 = 15, input_width2 = 15;
#endif

  uint32_t prev = device_get_tick();
  printf("mmm_test start (%d)\n", prev);
  prev = device_get_tick();

  volatile int *m = MMM_OUT;
  reg_write32(MMM_IW, input_width1);
  reg_write32(MMM_IW2, input_width2);
  reg_write8(MMM_PPRIME, 1);
  reg_write32(MMM_P, p[0]);
  reg_write32(MMM_A, a[0]);
  reg_write32(MMM_B, b[0]);
  // send ready signal
  reg_write8(MMM_CONTROL, 2);
  for(uint32_t i = 1; i < BLOCK; i++) 
  {
    reg_write32(MMM_P, p[i]);
    reg_write32(MMM_A, a[i]);
    reg_write32(MMM_B, b[i]);
  }

  // wait for peripheral to complete
  while ((reg_read8(MMM_STATUS) & 0x1) == 0) ;
  for(uint32_t i = 0; i < BLOCK; i++) 
  {
    result = reg_read32(m);
    if (result != ref[i]) {
        printf("Error at %d %X\n", i, result);
    }
  }
  reg_write8(MMM_CONTROL, 0);

  uint32_t complete = device_get_tick();
  printf("mmm_test end %d (%d -> %d)\n", complete - prev, prev, complete);

#ifdef Three_TEST
  prev = device_get_tick();
  printf("mmm_test again start (%d)\n", prev);
  prev = device_get_tick();

  reg_write8(MMM_PPRIME, 1);
  reg_write32(MMM_P, p1[0]);
  reg_write32(MMM_A, a1[0]);
  reg_write32(MMM_B, b1[0]);
  reg_write8(MMM_CONTROL, 2);
  for(uint32_t i = 1; i < BLOCK; i++) 
  {
    reg_write32(MMM_P, p1[i]);
    reg_write32(MMM_A, a1[i]);
    reg_write32(MMM_B, b1[i]);
  }

  while ((reg_read8(MMM_STATUS) & 0x1) == 0) ;
  for(uint32_t i = 0; i < BLOCK; i++) 
  {
    result = reg_read32(m);
    if (result != ref1[i]) {      
        printf("Error 2 at %d %X\n", i, result);
    }
  }
  reg_write8(MMM_CONTROL, 0);

  complete = device_get_tick();
  printf("mmm_test again end %d (%d -> %d)\n", complete - prev, prev, complete);
  
  prev = device_get_tick();
  printf("mmm_test again2 start (%d)\n", prev);
  prev = device_get_tick();

  reg_write32(MMM_IW, input_width1);
  reg_write32(MMM_IW2, input_width2);
  reg_write8(MMM_PPRIME, 1);
  reg_write32(MMM_P, p[0]);
  reg_write32(MMM_A, a[0]);
  reg_write32(MMM_B, b[0]);
  // send ready signal
  reg_write8(MMM_CONTROL, 2);
  for(uint32_t i = 1; i < BLOCK; i++) 
  {
    reg_write32(MMM_P, p[i]);
    reg_write32(MMM_A, a[i]);
    reg_write32(MMM_B, b[i]);
  }

  // wait for peripheral to complete
  while ((reg_read8(MMM_STATUS) & 0x1) == 0) ;
  for(uint32_t i = 0; i < BLOCK; i++) 
  {
    result = reg_read32(m);
    if (result != ref[i]) {
        printf("Error 3 at %d %X\n", i, result);
    }
  }
  reg_write8(MMM_CONTROL, 0);

  complete = device_get_tick();
  printf("mmm_test again end %d (%d -> %d)\n", complete - prev, prev, complete);
#endif
}
